<header><h1>
        &gt; Crypto[1]
    </h1>
</header>
<script type="text/javascript" src="/crypto/des.js"></script>
<script>
    function testFlag() {
        const input = document.getElementById('submitted-flag').value;
        digestMessage(input).then((digest) => 
            digest === "73aea9c077f25c7f9c8fcc3e2b17a0d6d1c67a036b2aee259fb0779af6ac5ca6" ? 
            alert("You found the flag!") : alert("Wrong flag!")
        );
    }
    async function digestMessage(message) {
        const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
        const hashBuffer = await window.crypto.subtle.digest("SHA-256", msgUint8); // hash the message
        const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
        const hashHex = hashArray
            .map((b) => b.toString(16).padStart(2, "0"))
            .join(""); // convert bytes to hex string
        return hashHex;
    }
</script>

<main>
    <p>
    The message below was encrypted using <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> 
    with <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)">ECB</a> mode.
    Each character in the message was padded with 7 spaces before being encrypted.
    </p>
    <p>
    The encryption library used is loaded into this page - you can play around with it by running <span class="code-box">des(string key, string message, boolean encrypt)</span> in the console of your browsers devtools.
    </p> 
    <div class="code-box">hU/fx9u/01Mm6TsZu0ujxRLU0OLVYZuPcY5qvAQYbYFpVnsFENXFMXGOarwEGG2BJuk7GbtLo8US1NDi1WGbj4VP38fbv9NTPQAHYqhMo54=</div>
    <div class="submission" hx-get="/submission.html" hx-trigger="load">
    </div>
</main>

