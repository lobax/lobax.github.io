<header><h1>
        &gt; Crypto[2]
    </h1>
</header>
<script type="text/javascript" src="/crypto/des.js"></script>
<script>
    function testFlag() {
        const input = document.getElementById('submitted-flag').value;
        digestMessage(input).then((digest) => 
            digest === "73aea9c077f25c7f9c8fcc3e2b17a0d6d1c67a036b2aee259fb0779af6ac5ca6" ? 
            alert("You found the flag!") : alert("Wrong flag!")
        );
    }
    async function digestMessage(message) {
        const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
        const hashBuffer = await window.crypto.subtle.digest("SHA-256", msgUint8); // hash the message
        const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
        const hashHex = hashArray
            .map((b) => b.toString(16).padStart(2, "0"))
            .join(""); // convert bytes to hex string
        return hashHex;
    }
</script>

<main>
    <p>
    The message below was encrypted using <a href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> 
    with <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_(CBC)">CBC</a> mode.
    The init vector is <span class="code-box">c803ce97</span> and you happen to know that the key is a zero-padded 8-charcter number (00000000 - 99999999). 
    </p>
    <div class="code-box">VmbNTu0obYhPV5XtTGLm1zDr+Dw3puEP05u6G9hNMFXN7+DYbdQ1dA==</div>
    <p>
    The encryption library used is loaded into this page, as last time. 
    For instance,<span class="code-box">btoa(des("12345678", "message", true, 1, "random_init"))</span> will produce 
    <span class="code-box">U6C2GZ0zSWg=</span>.
    Decrypting would be done with <span class="code-box">des("12345678", atob("U6C2GZ0zSWg="), false, 1, "random_init")</span>. 
    </p> 
    <div class="submission" hx-get="/ctf/submission.html" hx-trigger="load">
    </div>
</main>

